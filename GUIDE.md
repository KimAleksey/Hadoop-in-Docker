# üêò –ü—É—Ç–µ–≤–æ–¥–∏—Ç–µ–ª—å –ø–æ –≠–∫–æ—Å–∏—Å—Ç–µ–º–µ Hadoop –∏ Spark (Extended Edition)
*–î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–Ω—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ "–∫–∞–∫", –Ω–æ –∏ "–ø–æ—á–µ–º—É"*

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–∞—à–µ–≥–æ Big Data –∫–ª–∞—Å—Ç–µ—Ä–∞. –ú—ã –ø–æ–π–¥–µ–º –æ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞ (—Ö—Ä–∞–Ω–µ–Ω–∏—è) –∫ –≤–µ—Ä—à–∏–Ω–µ (–∞–Ω–∞–ª–∏—Ç–∏–∫–µ), —Ä–∞–∑–±–∏—Ä–∞—è –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º".

---

## üèó –ß–∞—Å—Ç—å 1: –°–ª–æ–π –•—Ä–∞–Ω–µ–Ω–∏—è (HDFS)

**HDFS (Hadoop Distributed File System)** ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç. –ë–µ–∑ –Ω–µ—ë –Ω–µ–≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏?
–û–±—ã—á–Ω—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (NTFS, EXT4) –∞–¥—Ä–µ—Å—É—é—Ç –±–∞–π—Ç—ã –Ω–∞ –¥–∏—Å–∫–µ. HDFS –∞–¥—Ä–µ—Å—É–µ—Ç **–±–ª–æ–∫–∏** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö.

#### 1. –ë–ª–æ–∫–∏ (Blocks)
–§–∞–π–ª –≤ HDFS –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º. –û–Ω "—à–∏–Ω–∫—É–µ—Ç—Å—è" –Ω–∞ –∫—É—Å–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é **128 –ú–ë**).
*   *–ó–∞—á–µ–º —Ç–∞–∫ –º–Ω–æ–≥–æ?* –í –æ–±—ã—á–Ω—ã—Ö –§–° –±–ª–æ–∫ = 4 –ö–ë. –ù–æ –µ—Å–ª–∏ —É –≤–∞—Å –ü–µ—Ç–∞–±–∞–π—Ç—ã –¥–∞–Ω–Ω—ã—Ö, –º–∏–ª–ª–∏–∞—Ä–¥—ã –º–∞–ª–µ–Ω—å–∫–∏—Ö –±–ª–æ–∫–æ–≤ "–≤–∑–æ—Ä–≤—É—Ç –º–æ–∑–≥" (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ) —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –ë–æ–ª—å—à–∏–µ –±–ª–æ–∫–∏ —É–º–µ–Ω—å—à–∞—é—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ NameNode.
*   *–ü—Ä–∏–º–µ—Ä*: –§–∞–π–ª `video.mp4` (500 –ú–ë) –±—É–¥–µ—Ç —Ä–∞–∑–±–∏—Ç –Ω–∞ 4 –±–ª–æ–∫–∞: 128 + 128 + 128 + 116.

#### 2. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è (Replication)
–í –Ω–∞—Å—Ç–æ—è—â–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ –∫–∞–∂–¥—ã–π –±–ª–æ–∫ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è 3 —Ä–∞–∑–∞ (Replication Factor = 3).
*   **–ö–æ–ø–∏—è 1**: –ù–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ, –∫—Ç–æ –ø–∏—à–µ—Ç.
*   **–ö–æ–ø–∏—è 2**: –í –¥—Ä—É–≥–æ–π —Å—Ç–æ–π–∫–µ (Rack).
*   **–ö–æ–ø–∏—è 3**: –í —Ç–æ–π –∂–µ —Å—Ç–æ–π–∫–µ, –Ω–æ –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ.
*   *–í –Ω–∞—à–µ–º Docker-–ø—Ä–æ–µ–∫—Ç–µ*: `dfs.replication = 1`, –ø–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–∞—Å –≤—Å–µ–≥–æ 1 DataNode.

#### 3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã HDFS
*   **NameNode (`namenode:9870`)**: –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä. –•—Ä–∞–Ω–∏—Ç **FileSystem Image (fsimage)** ‚Äî –∫–∞—Ä—Ç—É –≤—Å–µ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ó–Ω–∞–µ—Ç, —á—Ç–æ `/user/data/file.txt` —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –±–ª–æ–∫–æ–≤ `blk_1` –∏ `blk_2`.
    *   *–í–∞–∂–Ω–æ*: –í—Å—è —ç—Ç–∞ –∫–∞—Ä—Ç–∞ –∂–∏–≤–µ—Ç –≤ **RAM**. –ü–æ—ç—Ç–æ–º—É NameNode —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
*   **DataNode (`datanode:9864`)**: –•—Ä–∞–Ω–∏—Ç —Å–∞–º–∏ –±–ª–æ–∫–∏ —Å—ã—Ä—ã–º–∏ –±–∞–π—Ç–∞–º–∏. –ö–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã —à–ª–µ—Ç **Heartbeat** ("–Ø –∂–∏–≤") –∏ **Block Report** ("–£ –º–µ–Ω—è –µ—Å—Ç—å –±–ª–æ–∫–∏ –ê, –ë, –í") –Ω–∞ NameNode.

---

## üß† –ß–∞—Å—Ç—å 2: –°–ª–æ–π –†–µ—Å—É—Ä—Å–æ–≤ (YARN)

**YARN (Yet Another Resource Negotiator)** ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞. –û–Ω –¥–µ–ª–∏—Ç "–∂–µ–ª–µ–∑–æ" –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è
*   **Container**: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –∫—É—Å–æ–∫ –ü–∞–º—è—Ç–∏ (RAM) –∏ –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (CPU). –ù–∞–ø—Ä–∏–º–µ—Ä: `<2 –ì–ë RAM, 1 vCore>`.
*   **ApplicationMaster (AM)**: –£ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, Spark-–¥–∂–æ–±—ã) –µ—Å—Ç—å —Å–≤–æ–π "–º–∏–∫—Ä–æ-–º–µ–Ω–µ–¥–∂–µ—Ä". –û–Ω –ø—Ä–æ—Å–∏—Ç —Ä–µ—Å—É—Ä—Å—ã —É YARN–∞.
*   **Scheduler**: –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫. –†–µ—à–∞–µ—Ç, —á—å—è –æ—á–µ—Ä–µ–¥—å.
    *   *FIFO*: –ö—Ç–æ –ø–µ—Ä–≤—ã–π –≤—Å—Ç–∞–ª, —Ç–æ–≥–æ –∏ —Ç–∞–ø–∫–∏.
    *   *Capacity*: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –æ—Ç–¥–µ–ª–æ–≤ (–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ - 30%, IT - 70%).

---

## ‚ö°Ô∏è –ß–∞—Å—Ç—å 3: –°–ª–æ–π –û–±—Ä–∞–±–æ—Ç–∫–∏ (Apache Spark)

**Spark** ‚Äî —ç—Ç–æ –¥–≤–∏–∂–æ–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1.  **Driver**: –í–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ (—Å–∫—Ä–∏–ø—Ç Python –∏–ª–∏ `beeline`). –°–æ–¥–µ—Ä–∂–∏—Ç `SparkContext`. –°—Ç—Ä–æ–∏—Ç –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
2.  **Executors**: –ü—Ä–æ—Ü–µ—Å—Å—ã, –∂—É–∂–∂–∞—â–∏–µ –Ω–∞ —É–∑–ª–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞. –û–Ω–∏ —Ö—Ä–∞–Ω—è—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–¥–∞—á–∏ (Tasks).

### RDD: –°–µ—Ä–¥—Ü–µ Spark
–í—Å—ë –≤ Spark (–¥–∞–∂–µ DataFrame) —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ **RDD (Resilient Distributed Dataset)**.
*   **Resilient** (–£—Å—Ç–æ–π—á–∏–≤—ã–π): –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —Å–≥–æ—Ä–∏—Ç, Spark –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–π –∫—É—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø–æ "—Ä–æ–¥–æ—Å–ª–æ–≤–Ω–æ–π" (Lineage).
*   **Distributed**: –î–∞–Ω–Ω—ã–µ —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (Partitions).
*   **Dataset**: –ù–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö.

### DAG –∏ –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (Lazy Evaluation)
Spark –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç, –ø–æ–∫–∞ –≤—ã –µ–≥–æ –Ω–µ –ø–Ω–µ—Ç–µ.
*   **Transformations** (–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏): `filter`, `map`, `join`. –û–Ω–∏ **–ª–µ–Ω–∏–≤—ã–µ**. Spark –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç: "–ê–≥–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å".
*   **Actions** (–î–µ–π—Å—Ç–≤–∏—è): `count`, `collect`, `save`, `show`. –í–æ—Ç —Ç—É—Ç Spark –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è, —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (**DAG** - Directed Acyclic Graph) –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–∞–±–æ—Ç—É.

---

## üêù –ß–∞—Å—Ç—å 4: Metastore –∏ SQL (Hive)

**Apache Hive** –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª Hadoop –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

### Schema on Read (–°—Ö–µ–º–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏)
–í –æ–±—ã—á–Ω–æ–π –ë–î (Postgres) –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ —Å—Ö–µ–º—É.
–í Hadoop –≤—ã –ø—Ä–æ—Å—Ç–æ –∫–∏–¥–∞–µ—Ç–µ —Ñ–∞–π–ª—ã. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ (–°—Ö–µ–º–∞) –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–º.
*   –ï—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –º—É—Å–æ—Ä –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞, Hive –ø–æ–∫–∞–∂–µ—Ç `NULL`, –Ω–æ –∑–∞–ø—Ä–æ—Å –Ω–µ —É–ø–∞–¥–µ—Ç.

### Hive Metastore (`hive-metastore`)
–≠—Ç–æ —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü. –°–∞–º–∏ –¥–∞–Ω–Ω—ã–µ –ª–µ–∂–∞—Ç –≤ HDFS (`/user/hive/warehouse`), –∞ Metastore (–≤ PostgreSQL) –ø–æ–º–Ω–∏—Ç:
*   –ò–º—è —Ç–∞–±–ª–∏—Ü—ã: `users`
*   –ö–æ–ª–æ–Ω–∫–∏: `name (String)`, `age (Int)`
*   –§–æ—Ä–º–∞—Ç: `Parquet`
*   –ü—É—Ç—å: `hdfs://.../users`

### Managed vs External Tables
*   **Managed (–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è)**: Hive —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏ –¥–∞–Ω–Ω—ã–º–∏, –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏. `DROP TABLE` —É–¥–∞–ª–∏—Ç –∏ –∑–∞–ø–∏—Å—å –≤ –ë–î, –∏ —Ñ–∞–π–ª—ã –≤ HDFS.
*   **External (–í–Ω–µ—à–Ω—è—è)**: –í—ã –≥–æ–≤–æ—Ä–∏—Ç–µ Hive: "–ü–æ—Å–º–æ—Ç—Ä–∏ –≤–æ—Ç –≤ —Ç—É –ø–∞–ø–∫—É". `DROP TABLE` —É–¥–∞–ª–∏—Ç —Ç–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ, —Ñ–∞–π–ª—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è.

---

## üîå –ß–∞—Å—Ç—å 5: –ö–∞—Ä—Ç–∞ –ø–æ—Ä—Ç–æ–≤ –Ω–∞—à–µ–≥–æ Docker-–ø—Ä–æ–µ–∫—Ç–∞

–ß—Ç–æ–±—ã –≤—ã –Ω–µ –∑–∞–ø—É—Ç–∞–ª–∏—Å—å, –∫—É–¥–∞ —Å—Ç—É—á–∞—Ç—å—Å—è:

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç (Localhost) | –ß—Ç–æ —Ç–∞–º? | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç |
| :--- | :--- | :--- | :--- |
| **NameNode** | **9870** | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å HDFS (–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤) | 9870 |
| **ResourceManager** | **8088** | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å YARN (—Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π) | 8088 |
| **Spark Master** | **8090** | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Spark –°luster | 8080 |
| **Spark Worker** | **8081** | –õ–æ–≥–∏ –∏ —Å—Ç–∞—Ç—É—Å –≤–æ—Ä–∫–µ—Ä–∞ | 8081 |
| **Thrift Server** | **10000** | JDBC –ø–æ—Ä—Ç –¥–ª—è DBeaver (SQL) | 10000 |
| **Thrift UI** | **4040*** | UI —Ç–µ–∫—É—â–µ–π –¥–∂–æ–±—ã (–≤–∏–¥–µ–Ω –Ω–µ –≤—Å–µ–≥–¥–∞) | 4040 |
| **Jupyter** | **8888** | –ù–æ—É—Ç–±—É–∫–∏ Python | 8888 |
| **History Server** | **8188** | –ê—Ä—Ö–∏–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á | 8188 |

---

## üõ† –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –°–æ–≤–µ—Ç—ã

### –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞?
*   **CSV**: –ü–ª–æ—Ö–æ. –ù–µ—Ç —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –º–µ–¥–ª–µ–Ω–Ω–æ —á–∏—Ç–∞–µ—Ç—Å—è, –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞. –¢–æ–ª—å–∫–æ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ "—Å—ã—Ä—ã—Ö" –¥–∞–Ω–Ω—ã—Ö.
*   **Parquet**: –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –ö–æ–ª–æ–Ω–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ï—Å–ª–∏ –≤—ã –≤—ã–±–µ—Ä–µ—Ç–µ `SELECT age FROM users`, –æ–Ω –ø—Ä–æ—á–∏—Ç–∞–µ—Ç —Å –¥–∏—Å–∫–∞ –¢–û–õ–¨–ö–û –∫–æ–ª–æ–Ω–∫—É `age`.
*   **ORC**: –ê–Ω–∞–ª–æ–≥ Parquet, –ª—É—á—à–µ —Å–∂–∞—Ç, —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Hive.
*   **Avro**: –°—Ç—Ä–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –•–æ—Ä–æ—à, –µ—Å–ª–∏ —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è (Schema Evolution).

### –ü–æ—á–µ–º—É –º–æ–π –∑–∞–ø—Ä–æ—Å —Ç–æ—Ä–º–æ–∑–∏—Ç?
1.  **Shuffle**: –ï—Å–ª–∏ –≤—ã –¥–µ–ª–∞–µ—Ç–µ `JOIN` –∏–ª–∏ `GROUP BY`, –¥–∞–Ω–Ω—ã–µ –ª–µ—Ç–∞—é—Ç –ø–æ —Å–µ—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏. –≠—Ç–æ —Å–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.
2.  **–ú–∞–ª–µ–Ω—å–∫–∏–µ —Ñ–∞–π–ª—ã**: 1000 —Ñ–∞–π–ª–æ–≤ –ø–æ 1 –ö–ë ‚Äî —Å–º–µ—Ä—Ç—å –¥–ª—è HDFS –∏ Spark. –õ—É—á—à–µ 1 —Ñ–∞–π–ª –Ω–∞ 1 –ú–ë. –î–µ–ª–∞–π—Ç–µ `.coalesce(1)` –∏–ª–∏ `.repartition()` –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é.

---

*–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –≤–∞—à–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞!* üöÄ
